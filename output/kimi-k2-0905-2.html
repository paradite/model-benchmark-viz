<!DOCTYPE html>
<html>
  <head>
    <title>Model Benchmark Results</title>
    <meta charset="utf-8" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial,
          sans-serif;
        margin: 0;
        padding: 2rem;
        background: #f7f7f7;
      }
      h1 {
        text-align: center;
        margin-bottom: 2rem;
      }
      #chart-container {
        max-width: 900px;
        margin: 0 auto;
        background: #fff;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      #legend {
        margin-top: 1.5rem;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1rem;
      }
      .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .legend-color {
        width: 20px;
        height: 20px;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <h1>Model Benchmark Results</h1>
    <div id="chart-container">
      <canvas id="benchmarkChart"></canvas>
      <div id="legend"></div>
    </div>

    <script src="results.js"></script>
    <script>
      // Helper: normalize kcores_llm_arena score (0-400 -> 0-100)
      function normalizeKcores(score) {
        return (score / 400) * 100;
      }

      // Assign a unique color to each model
      const modelColors = {
        "o3 (high)": "#1f77b4",
        "o4-mini (high)": "#ff7f0e",
        "GPT-4.1": "#2ca02c",
        "Claude 3.5 Sonnet": "#d62728",
        "Claude 3.7 Sonnet (Thinking)": "#9467bd",
        "Gemini 2.5 Pro": "#8c564b",
        "DeepSeek R1": "#e377c2",
        "DeepSeek V3 (0324)": "#7f7f7f",
        "Grok 3 Beta": "#bcbd22",
      };

      // Prepare datasets
      const aiderData = [];
      const kcoresData = [];
      const labels = [];

      Object.entries(results).forEach(([model, benchmarks]) => {
        labels.push(model);
        // Aider polyglot (already 0-100)
        aiderData.push(benchmarks.aider_polyglot ? benchmarks.aider_polyglot.percent_correct : 0);
        // KCORES LLM Arena (normalize 0-400 to 0-100)
        kcoresData.push(
          benchmarks.kcores_llm_arena
            ? normalizeKcores(benchmarks.kcores_llm_arena.normalized_score)
            : 0,
        );
      });

      // Build datasets for Chart.js
      const datasets = [
        {
          label: "Aider polyglot coding leaderboard",
          data: aiderData,
          backgroundColor: labels.map(m => modelColors[m] + "cc"),
          borderColor: labels.map(m => modelColors[m]),
          borderWidth: 2,
        },
        {
          label: "KCORES LLM Arena",
          data: kcoresData,
          backgroundColor: labels.map(m => modelColors[m] + "66"),
          borderColor: labels.map(m => modelColors[m]),
          borderWidth: 2,
          borderDash: [5, 5],
        },
      ];

      // Create chart
      const ctx = document.getElementById("benchmarkChart").getContext("2d");
      const benchmarkChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: labels,
          datasets: datasets,
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: "Model Benchmark Comparison (Normalized 0-100)",
              font: {size: 18},
            },
            legend: {
              display: true,
              position: "top",
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  let label = context.dataset.label || "";
                  if (label) {
                    label += ": ";
                  }
                  label += context.parsed.y.toFixed(1);
                  return label;
                },
              },
            },
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              title: {
                display: true,
                text: "Normalized Score (0-100)",
              },
            },
            x: {
              title: {
                display: true,
                text: "Models",
              },
            },
          },
        },
      });

      // Build custom legend for model colors
      const legendContainer = document.getElementById("legend");
      labels.forEach(model => {
        const item = document.createElement("div");
        item.className = "legend-item";
        const colorBox = document.createElement("div");
        colorBox.className = "legend-color";
        colorBox.style.backgroundColor = modelColors[model];
        const label = document.createElement("span");
        label.textContent = model;
        item.appendChild(colorBox);
        item.appendChild(label);
        legendContainer.appendChild(item);
      });
    </script>
  </body>
</html>
